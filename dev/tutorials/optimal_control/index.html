<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Optimal Population Control of Noisy Lotka-Volterra System · MarkovBounds.jl</title><link rel="canonical" href="https://FHoltorf.github.io/MarkovBounds.jl/tutorials/optimal_control/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">MarkovBounds.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../background/">Background</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../birth_death_process/">Analysis of a Birth-Death Processes</a></li><li><a class="tocitem" href="../jump_diffusion_process/">Analysis of Cox-Ingersoll-Ross Model Modified by Jumps</a></li><li class="is-active"><a class="tocitem" href>Optimal Population Control of Noisy Lotka-Volterra System</a></li></ul></li><li><a class="tocitem" href="../../functionalities/">Functionalities</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Optimal Population Control of Noisy Lotka-Volterra System</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Optimal Population Control of Noisy Lotka-Volterra System</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/FHoltorf/MarkovBounds.jl/blob/master/docs/src/tutorials/optimal_control.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Optimal-Population-Control-of-Noisy-Lotka-Volterra-System"><a class="docs-heading-anchor" href="#Optimal-Population-Control-of-Noisy-Lotka-Volterra-System">Optimal Population Control of Noisy Lotka-Volterra System</a><a id="Optimal-Population-Control-of-Noisy-Lotka-Volterra-System-1"></a><a class="docs-heading-anchor-permalink" href="#Optimal-Population-Control-of-Noisy-Lotka-Volterra-System" title="Permalink"></a></h1><p>The same techniques used for studying the statistics of stochastic processes can be used to study different variations of stochastic optimal control problems.</p><p>In this example, we consider a problem from population control. The control system is modeling the interaction between a predator and prey species modeled by the following diffusion dynamics</p><p class="math-container">\[        \begin{bmatrix} dx_{1} \\ d x_{2} \end{bmatrix} = \begin{bmatrix} γ_1 x_1 - γ_2 x_1 x_2 \\ \gamma_4 x_1 x_2 - \gamma_3 x_2 - x_2 u \end{bmatrix} \, dt + \begin{bmatrix} \gamma_5 x_1  \\ 0 \end{bmatrix} dW_t\]</p><p>The control action u models the hunting effort of the predator species, while x₁ and x₂ refer to the population sizes of both species. The goal is to control the population sizes to a desired level of <span>$x_1 = 0.75$</span> and <span>$x_2 = 0.5$</span>. To that end, we solve the following optimal control problem:</p><p class="math-container">\[\begin{aligned}
        \min_{u(\cdot)} \quad &amp; \mathbb{E}\left[ \int_0^T (x_1(t) - 0.75)^2 + \frac{(x_2(t) - 0.5)^2}{10} + \frac{(u(t) - 0.5)^2}{10} dt\right] \\
        \text{s.t.} \quad &amp; u(t) ∈ [0,1], \\
                &amp; x(t) ∈ \mathbb{R}^2_+, \\
                &amp; x(0) \sim \mu_0
\end{aligned}\]</p><p>To solve this problem we define the associated <code>ControlProcess</code> in two steps. First, we define the diffusion process via its diffusion matrix, drift coeff. and state space:</p><pre><code class="language-julia">@polyvar(x[1:2]) # state variables
@polyvar(u) # control variables
@polyvar(t) # time variable
X = @set(x[1] &gt;= 0 &amp;&amp; x[2] &gt;= 0) # state space

γ = [1, 2, 1, 2, 0.25*0.1] # model parameters

f = [γ[1] * x[1] - γ[2] * x[1] * x[2] ;
     γ[4] * x[1] * x[2] - γ[3] * x[2] - x[2]*u] # drift coefficient

g = [γ[5]*x[1]; 0] # diffusion coefficient
σ = polynomial.(g*g&#39;) # diffusion matrix

lv = DiffusionProcess(x, f, σ, X, time = t, controls = [u])</code></pre><p>In a second step, we define the control process with its objective function and set of admissible control actions.</p><pre><code class="language-julia">U = @set(u &gt;= 0 &amp;&amp; u &lt;= 1) # set of admissible controls|
stagecost = (x[1]-0.75)^2 + (x[2] - 0.5)^2/10 + (u - 0.5)^2/10
obj = Lagrange(stagecost) # Lagrange type objective
T = 10.0 # control horizon
lv_control = ControlProcess(lv, T, U, obj)</code></pre><p>Now almost everything is set up to determine a lower bound on the objective value associated with the control problem CP. We only need to specify the distribution of the initial state of the process. This specification is done through the moments of the distribution. In this example, we consider the the initial condition to be known deterministically such that the moments are easily computed. The moments are supplied in form of a dictionary mapping the monomial of the state to the corresponding moment.</p><p>The number of moments that needs to be specified depends on the relaxation order used: If order d is used, all moments up to order d + max(deg(f) - 1, deg(σ) - 2, 0) require specification.</p><pre><code class="language-julia">order = 6
x0 = [1.0, 0.25]
μ0 = Dict(x[1]^i*x[2]^j =&gt; x0[1]^i*x0[2]^j for i in 0:order+1, j in 0:order+1) # moments of initial distribution
trange = range(0, T, length = 11) # discretization of time horizon
b = optimal_control(lv_control, μ0, order, trange, Mosek.Optimizer)</code></pre><p>The numerical result of this operation provides a lower bound of 0.2089 on the minimal control cost attainable by any admissible control policy.</p><p>From the optimal solution of the bounding problem, we can further identify a polynomial approximation to the value function. If the time horizon is discretized in more than one piece, this approximation will be a piecewise polynomial. By calling the value_function function as shown below we can extract this piecewise polynomial in the form of two functions. The first output maps any point (x,t) -&gt; to the corresponding polynomial, while the second output is a function that directly evaluates this polynomial at (x,t):</p><pre><code class="language-julia">V_poly, V_val = value_function(lv_control, trange, b);</code></pre><p>This information can be used to construct controllers as shown in the following</p><pre><code class="language-julia">urange = 0:0.05:1
function controller(x,s)
    obj = stagecost + extended_inf_generator(DP, V_poly(s,x))
    return urange[argmin([obj(x...,u,s) for u in urange])]
end

drift(x,p,t) = [f[1](x...), f[2](x..., controller(x, t))]
diffusion(x,p,t) = [g[1](x[1]), 0]
prob = EnsembleProblem(SDEProblem(drift, diffusion, x0, (0.0, T)))
sol = DifferentialEquations.solve(prob, EM(), dt = 0.01, trajectories = 100)</code></pre><p>The obtained system trajectories are shown below. They clearly demonstrate that the above constructed controller does a reasonable job at steering the system to the desired setpoint. Moreover, after estimating the control cost achieved by this controller via sampling, the computed lower bound can be used to certify (with high confidence) that the constructed controller is no more than 3% suboptimal. </p><p><img src="../images/control_trajectories.svg" alt/></p><p>For more details on the code used in this example, please review <a href="https://github.com/FHoltorf/MarkovBounds.jl/blob/master/tutorials/optimal_control.ipynb">this jupyter notebook</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../jump_diffusion_process/">« Analysis of Cox-Ingersoll-Ross Model Modified by Jumps</a><a class="docs-footer-nextpage" href="../../functionalities/">Functionalities »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 27 February 2023 22:14">Monday 27 February 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
